!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function n(e){return`${("0"+e.getDate()).slice(-2)}.${("0"+(e.getMonth()+1)).slice(-2)}.${e.getFullYear()} ${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}`}function s(e){let t=0;$("#wiki-data").empty(),$.each(e,(e,i)=>{const n=`https://ru.wikipedia.org/w/api.php?format=json&action=query&origin=*&prop=extracts&explaintext=&titles=${i}`;$.ajax({url:n,type:"GET",success:e=>{$.each(e.query.pages,(e,i)=>{let n=i.extract;t+=n.length})}})}),setTimeout(function(){const i=t/e.length;$("#wiki-data").append($(`<p>Среднее количество символов по выгруженным статьям - ${i}</p>`))},1e3)}function r(e){let t=[],i=[];$.each(e,(e,n)=>{const s=`https://ru.wikipedia.org/w/api.php?action=query&origin=*&prop=revisions&titles=${n}&format=json`;$.ajax({url:s,type:"GET",success:e=>{$.each(e.query.pages,(e,n)=>{let s=n.revisions[0].timestamp;t.push(s),i.push({title:n.title,date:s})})}})}),setTimeout(function(){const e=t.reduce((e,t)=>e>t?e:t);$.each(t,(t,n)=>{if(i[t].date==e){let e=i[t].date.replace("T"," ");e=e.replace("Z"," "),$("#wiki-data").append($(`<p>Самая свежая статья - "${i[t].title}" была обновлена ${e}</p>`))}});const n=t.reduce((e,t)=>e<t?e:t);$.each(t,(e,t)=>{if(i[e].date==n){let t=i[e].date.replace("T"," ");t=t.replace("Z"," "),$("#wiki-data").append($(`<p>Самая старая статья - "${i[e].title}" была обновлена ${t}</p>`))}})},1e3)}function a(){const e=Date.now();let t=0;const i=n(new Date),a=document.getElementById("search-form__input");if(""==a.value)return void alert("Необходимо ввести текст в поле поиска!");let o=l(a.value);const c="http://ru.wikipedia.org/w/api.php?action=opensearch&origin=*&search="+encodeURI(o)+"&profile=strict&limit=5&format=json";$.ajax({url:c,type:"GET",success:n=>{if(0!=n[1].length){$("#wiki-items").empty();for(let e=0;e<n[1].length;e++)$("#wiki-items").append($('<h5><a href="'+n[3][e]+'">'+n[1][e]+"</a></h5>")),$("#wiki-items").append($("<p>"+n[2][e]+"</p>"));setTimeout(s,100,n[1]),setTimeout(r,100,n[1]),t=Date.now()-e,function(e,t,i){let n=[];if(null!==localStorage.getItem("queries")){const e=JSON.parse(localStorage.getItem("queries"));$.each(e,(e,t)=>{n.push(t)})}10==n.length&&n.shift(),n.push({query:e,queryTime:t,loadTime:i});const s=JSON.stringify(n);localStorage.setItem("queries",s)}(o,i,t)}else alert("Не найдено ни одной статьи:(")}})}function l(e){return e.replace(/[^\s-a-zA-ZА-Яа-яЁё]/gi,"")}function o(e){$("#wiki-queries tbody").empty(),$.each(e,(e,t)=>{const i='<tr class="userQuery"><td class="query">'+t.query+'</td><td class="queryTime">'+t.queryTime+'</td><td class="queryLoadTime">'+t.loadTime+"</td></tr>";$("#wiki-queries tbody").append($(i))})}function c(e){const t=e.find(".filter");e.find(".userQuery").each(function(e){let i=!0;$(this).find("td").each(function(e){t.eq(e).val()&&-1==$(this).html().toLowerCase().indexOf(t.eq(e).val().toLowerCase())&&(i=i&&!1)}),!0===i?$(this).css("display",""):$(this).css("display","none")})}i.r(t);let u=1,d=1,p=1;function y(e){let t=[];const i=document.getElementsByClassName("query"),n=document.getElementsByClassName("queryTime"),s=document.getElementsByClassName("queryLoadTime");$("#wiki-queries tbody tr").each((e,r)=>{t.push({query:i[e].textContent,queryTime:n[e].textContent,loadTime:s[e].textContent})}),"byQuery"==e&&(1!=u?t.reverse():t.sort((e,t)=>e.query.localeCompare(t.query)),u++,d=1,p=1),"byQueryTime"==e&&(1!=d?t.reverse():t.sort((e,t)=>e.queryTime.localeCompare(t.queryTime)),u=1,d++,p=1),"byQueryLoadTime"==e&&(1!=p?t.reverse():t.sort((e,t)=>e.loadTime-t.loadTime),u=1,d=1,p++),o(t),""!==$("#wiki-queries table").find(".filter").value&&c($("#wiki-queries table"))}const m=document.getElementById("wiki-items"),f=document.getElementById("wiki-queries"),g=document.getElementById("wiki-data"),h=document.getElementById("wiki-statistics");$(document).ready(()=>{let e=document.head,t=document.createElement("link");t.rel="stylesheet","dark"===localStorage.getItem("themeStyle")?t.href="../css/dark.css":t.href="../css/light.css",e.appendChild(t),$("#search-form").submit(e=>{e.preventDefault(),a(),m.style.display="block",f.style.display="none",g.style.display="block",h.style.display="none"}),$("#getOldQueries").on("click",()=>{o(JSON.parse(localStorage.getItem("queries"))),m.style.display="none",f.style.display="block",g.style.display="none",h.style.display="none"}),$("#sortQueries").on("click",()=>{y("byQuery")}),$("#sortQueriesTime").on("click",()=>{y("byQueryTime")}),$("#sortQueriesLoadTime").on("click",()=>{y("byQueryLoadTime")}),$(".filter").on("input",function(){c($(this).parents("table"))}),$("#getStatistics").on("click",()=>{!function(){$("#wiki-statistics").empty();const e=JSON.parse(localStorage.getItem("queries"));$.each(e,(e,t)=>{var i=document.createElement("div");i.style.height=`${t.loadTime}px`,i.textContent=`${t.query} - ${t.loadTime}`,$("#wiki-statistics").append($(i))})}(),m.style.display="none",f.style.display="none",g.style.display="none",h.style.display="flex"}),$("#switchStyle").on("click",()=>{"light"==localStorage.getItem("themeStyle")?(t.href="../css/dark.css",localStorage.setItem("themeStyle","dark")):(t.href="../css/light.css",localStorage.setItem("themeStyle","light"))}),QUnit.test("update string",function(e){e.equal(l("strin#g"),"string"),e.equal(l("!@s#$%tr^&*i&*(n#g)"),"string"),e.equal(l("str-in-g"),"str-in-g"),e.equal(l("str147`ing str-ng"),"string str-ng")}),QUnit.test("update date",function(e){const t=new Date(2011,0,1,12,34,0,0),i=new Date(2011,0,1),s=new Date(1356,0,1,0,7);e.equal(n(t),"01.01.2011 12:34"),e.equal(n(i),"01.01.2011 00:00"),e.equal(n(s),"01.01.1356 00:07")})})}]);